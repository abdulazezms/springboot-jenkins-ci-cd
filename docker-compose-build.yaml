version: '3'
services:




  mysql:
   container_name: mysql
   image: mysql:5.7
   command:
     - --init-file /data/application/init.sql
   environment:
     - "MYSQL_ROOT_PASSWORD=1234"
   volumes:
     - "/db_data:/var/lib/mysql"
     - ./init.sql:/data/application/init.sql
   networks:
     - net


  web-app:
    container_name: web-app
    image: "books-manager:$BUILD_TAG"
    build:
      context: .
    environment:
      - "DATABASE_HOST=jdbc:mysql://mysql:3306/books-store"
      - "DATABASE_USERNAME=root"
      - "DATABASE_PASSWORD=1234"
      - "SERVER_PORT=8081"
    ports:
      - "8081:8081"
    depends_on:
      - db_host
    networks:
      - net

networks:
  net: